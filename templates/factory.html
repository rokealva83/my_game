{% extends "base.html" %}
{% load staticfiles %}
{% block title %}Производство{% endblock %}

{% block content %}

    <link rel="stylesheet" type="text/css" href="{% static 'css/factory.css' %}">
    <div class="factory_up">
        <p>{{ message }}</p>
    </div>

    <div class="factory_left">
        <form method="post" action="choice_element">

            <p>Выберите фабрику продукции</p>

            <p><input class="choice_element" type="submit" value="Корпуса" name="hull"/></p>

            <p><input class="choice_element" type="submit" value="Броня" name="armor"/></p>

            <p><input class="choice_element" type="submit" value="Щиты" name="shield"/></p>

            <p><input class="choice_element" type="submit" value="Двигатели" name="engine"/></p>

            <p><input class="choice_element" type="submit" value="Генераторы" name="generator"/></p>

            <p><input class="choice_element" type="submit" value="Оружие" name="weapon"/></p>

            <p><input class="choice_element" type="submit" value="Боеприпасы" name="shell"/></p>

            <p><input class="choice_element" type="submit" value="Модули" name="module"/></p>

            <p><input class="choice_element" type="submit" value="Устройства" name="device"/></p>
        </form>
        <br>
        {% if manufacturing_complexs %}
            <p>Выберите комплекс</p>

            <form method="post" action="choice_complex">
                <p><select name="complex_id" class="choice_element">
                    <option value="0">Выберите комплекс</option>
                    {% for manufacturing_complex in manufacturing_complexs %}
                        <option value="{{ manufacturing_complex.id }}">{{ manufacturing_complex.name }}</option>
                    {% endfor %}
                </select></p>
                <p><input class="choice_element" type="submit" value="Выбрать"/></p>
            </form>
        {% endif %}

    </div>
    <div class="factory_right">
        {% if complex_id %}
            {% for factory_installed in factory_installeds %}


                    <input class="toggle-box" id="factory{{ factory_installed.id }}" type="checkbox" align="left">

                    <label for="factory{{ factory_installed.id }}"><b>{{ factory_installed.name }}</b></label>

                    <div class="inform_place">

                        {% for element_pattern in element_patterns %}
                            {% if element_pattern.basic_id == factory_installed.production_id %}
                                <input class="toggle-box"
                                       id="factory{{ factory_installed.id }}element{{ element_pattern.id }}"
                                       type="checkbox"
                                       align="left">
                                <label for="factory{{ factory_installed.id }}element{{ element_pattern.id }}"><b>{{ element_pattern.name }}</b>

                                </label>
                                <div class="inform_place">

                                    <form method="post" action="production">
                                        <input type="new_name" value="" name="new_name" class="scientic_place"
                                               placeholder="Новое название модуля"/>
                                        <input id="rename" class="scientic" type="submit"
                                               value="Rename" name="rename_element_pattern"/>
                                        <input type="hidden" id="factory{{ factory_installed.id }}"
                                               value={{ factory_installed.id }} name="hidden_factory">
                                        <input type="hidden" id="element{{ element_pattern.id }}"
                                               value={{ element_pattern.id }} name="hidden_element">
                                    </form>

                                    <p class="factory_information">
                                        {% for attribute in attributes %}

                                            {% load my_filter %}
                                            {% if element_pattern|getattribute:attribute != 0 %}
                                                {{ attribute }}: <b>{{ element_pattern|getattribute:attribute }}</b>;
                                            {% endif %}

                                        {% endfor %}
                                    </p>

                                    <form method="post" action="production">
                                        <p>Количество елементов<input type="amount_element" value=""
                                                                      name="amount_element"
                                                                      class="scientic_place"
                                                                      id="amount{{ element_pattern.id }}"
                                                                      placeholder="Количество елементов"/>
                                            <input type="hidden" id="factory{{ factory_installed.id }}"
                                                   value={{ factory_installed.id }} name="hidden_factory">
                                            <input type="hidden" id="element{{ element_pattern.id }}"
                                                   value={{ element_pattern.id }} name="hidden_element">
                                            <input id="amount_element" class="scientic" type="submit"
                                                   value="Create" name="buttom_amount_element"/></p>
                                    </form>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
            {% endfor %}
        {% else %}
            {% for factory_installed in factory_installeds %}
                {% if 10 > factory_installed.production_class %}
                    <div style="margin-bottom: 15px">
                        <form method="post" action="production">

                            {% if turn_productions %}
                                {% for turn_production in turn_productions %}
                                    {% if turn_production.factory_id == factory_installed.id %}
                                        <p> Очередь строительства </p>
                                        <p>{{ turn_production.finish_time_production }}</p>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            <input class="toggle-box" id="factory{{ factory_installed.id }}" type="checkbox"
                                   align="left">

                            <label for="factory{{ factory_installed.id }}"><b>{{ factory_installed.name }}</b></label>

                            <div class="inform_place">

                                {% for element_pattern in element_patterns %}
                                    {% if element_pattern.basic_id == factory_installed.production_id %}
                                        <input class="toggle-box"
                                               id="factory{{ factory_installed.id }}element{{ element_pattern.id }}"
                                               type="checkbox"
                                               align="left">
                                        <label for="factory{{ factory_installed.id }}element{{ element_pattern.id }}"><b>{{ element_pattern.name }}</b>

                                        </label>
                                        <div class="inform_place">

                                            <form method="post" action="production">
                                                <input type="new_name" value="" name="new_name" class="scientic_place"
                                                       placeholder="Новое название модуля"/>
                                                <input id="rename" class="scientic" type="submit"
                                                       value="Rename" name="rename_element_pattern"/>
                                                <input type="hidden" id="factory{{ factory_installed.id }}"
                                                       value={{ factory_installed.id }} name="hidden_factory">
                                                <input type="hidden" id="element{{ element_pattern.id }}"
                                                       value={{ element_pattern.id }} name="hidden_element">
                                            </form>

                                            <p class="factory_information">
                                                {% for attribute in attributes %}

                                                    {% load my_filter %}
                                                    {% if element_pattern|getattribute:attribute != 0 %}
                                                        {{ attribute }}:
                                                        <b>{{ element_pattern|getattribute:attribute }}</b>
                                                        ;
                                                    {% endif %}

                                                {% endfor %}
                                            </p>

                                            <form method="post" action="production">
                                                <p>Количество елементов<input type="amount_element" value=""
                                                                              name="amount_element"
                                                                              class="scientic_place"
                                                                              id="amount{{ element_pattern.id }}"
                                                                              placeholder="Количество елементов"/>
                                                    <input type="hidden" id="factory{{ factory_installed.id }}"
                                                           value={{ factory_installed.id }} name="hidden_factory">
                                                    <input type="hidden" id="element{{ element_pattern.id }}"
                                                           value={{ element_pattern.id }} name="hidden_element">
                                                    <input id="amount_element" class="scientic" type="submit"
                                                           value="Create" name="buttom_amount_element"/></p>
                                            </form>

                                        </div>
                                    {% endif %}
                                {% endfor %}

                            </div>
                        </form>
                        <form method="post" action="production">
                            <input type="hidden" id="factory{{ factory_installed.id }}"
                                   value={{ factory_installed.id }} name="hidden_factory">
                            <input class="scientic" type="submit" value="Disassembling factory"
                                   name="disassembling"/>
                        </form>
                    </div>
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>

    <div class="clear"></div>


{% endblock %}